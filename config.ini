[GENERAL]
logging_level=INFO
control_route_key=control

[RABBIT]
address=rabbitmq

[CLIENT]
address=request_listener
port=25555

[REQUEST_LISTENER]
input_exchange=answers_ex
current_stage_name=request_listener
previous_stage_amount=1,1,1
output_exchange=entries_ex
next_stage_amount=1,1
next_stage_name=all_countries_agg,likes_filter
hashing_attributes=client_id,video_id|client_id,video_id

port=25555
flows_amount=3
output_columns=client_id,type,video_id,title,categoryId,tags,view_count,trending_date,country

[LIKES_FILTER]
input_exchange=entries_ex
current_stage_name=likes_filter
previous_stage_amount=1
output_exchange=liked_entries_ex
next_stage_amount=1,1
next_stage_name=tag_filter, max_day_filter
hashing_attributes=client_id,video_id|client_id,trending_date

output_columns=client_id,type,video_id,title,categoryId,tags,view_count,trending_date
min_likes=1000000

[TAG_FILTER]
input_exchange=liked_entries_ex
current_stage_name=tag_filter
previous_stage_amount=1
output_exchange=tag_entries_ex
next_stage_amount=1
next_stage_name=duplicates_filter
hashing_attributes=client_id,video_id

output_columns=client_id,type,video_id,title,categoryId
target_tag=funny

[DUPLICATES_FILTER]
input_exchange=tag_entries_ex
current_stage_name=duplicates_filter
previous_stage_amount=1
output_exchange=answers_ex
next_stage_amount=1
next_stage_name=request_listener
hashing_attributes=client_id,video_id

output_columns=client_id,type,case,video_id,title,categoryId
storage=./id_duplicate_files/

[MAX_DAY_FILTER]
input_exchange=liked_entries_ex
current_stage_name=max_day_filter
previous_stage_amount=1
output_exchange=max_day_entries_ex
next_stage_amount=1
next_stage_name=max_day_agg
hashing_attributes=client_id,video_id

output_columns=client_id,type,video_id,title,categoryId,view_count
storage=./date_files/
target_column=view_count

[MAX_AGG_FILTER]
input_exchange=max_day_entries_ex
current_stage_name=max_day_agg
previous_stage_amount=1
output_exchange=answers_ex
next_stage_amount=1
next_stage_name=request_listener
hashing_attributes=client_id,video_id

[ALL_COUNTRIES_AGG]
input_exchange=entries_ex
current_stage_name=all_countries_agg
previous_stage_amount=1
output_exchange=all_countries_entries_ex
next_stage_amount=1
next_stage_name=tumbnail_downloader
hashing_attributes=client_id,video_id

output_columns=client_id,type,video_id,thumbnail_link
storage=./id_country_files/
min_days=3

[THUMBNAIL_DOWNLOADER]
input_exchange=all_countries_entries_ex
current_stage_name=thumbnail_downloader
previous_stage_amount=1
output_exchange=answers_ex
next_stage_amount=1
next_stage_name=request_listener
hashing_attributes=client_id,video_id
